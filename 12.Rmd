---
title: "data"
author: "julia"
date: "2023-10-23"
output:
  html_document:
    df_print: paged
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```





```{r}
library(readxl)
library(ggplot2)
library(ggiraph)
library(patchwork)
library(plotly)
X <-read_excel("C:/Users/Xinyue Zhan/Desktop/useful research papers/datafinal.xlsx",sheet=1)
agent.strain<- X[,5]
ci<-function(expo,infec){
  alpha<- infec + 0.5
  beta <- (expo-infec) +0.5
  cf <-pbeta(c(0.05), alpha, beta)
  
  return(cf)
}
cg<-function(expo,infec){
  alpha<- infec + 0.5
  beta <- (expo-infec) +0.5
  pf <-pbeta(c(0.95), alpha, beta)
  
  return(pf)
}

cq<-function(expo,infec){
  alpha<- infec + 0.5
  beta <- (expo-infec) +0.5
  re <-pbeta(c(0.50), alpha, beta)
  
  return(re)
}
lowe<-ci(expo = X$exposure, infec = X$infected)
lower<-round(lowe, 7)
upper<-cg(expo = X$exposure, infec = X$infected)
data<- data.frame(x=X$dose, y=X$infection.rate, u=upper, L=lower)
hal<-cq(expo = X$exposure, infec = X$infected)
half<-round(hal, 7)
plotgr<- function(data){
  line_data <- data.frame(
    x = c(data$x, data$x),
    y = c(data$L, data$u)
  )
  ggplot(data, aes(x = x, y = y, color=X$agent.strain)) +  geom_point(size = 2) +
  geom_segment(aes(xend = x, yend = L), linetype = 1, color = "blue", size = 1) +
  geom_segment(aes(xend = x, yend = u), linetype = 1, color = "blue", size = 1)+
    geom_segment(aes(xend = x, yend = half), linetype = 1, color = "lightblue", size = 0.5)+
    geom_ribbon(aes(ymin=L, ymax=u), alpha = 0.3, fill="lightgreen", color="yellow")+ 
    geom_point(size = 2)+
    scale_x_log10(labels = scales::comma) +
            theme_minimal()+   #make the data frame white                                      
      labs(title = "Probability of infection among various STEC",
          x= "amount of dose",
          y="probability",
          color = "agent strain") 
}
  


# Plot the data
plotgr(data)
print(X)
print(lower)
print(upper)
print(half)
```




















